# Chapter 2 - 디버깅으로 앱 로직 이해하기
- 주요 내용
  - 디버거를 사용할 때와 사용하지 말아야할 때는 언제인가?
  - 디버거로 코드 조사하기

- 참고하면 좋은 자료
  - [[10분 테코톡] 🍟 웨지의 인텔리제이 디버깅](https://youtu.be/gkutTlwi70s?si=NFh-XLOODmca1kzI)
  - [IntelliJ 디버깅 해보기 By jojoldu](https://jojoldu.tistory.com/149)
 
## 2.1 코드 분석만으로 불충분한 경우
- 코드를 읽는 것만으로 코드를 이해하기 어려운 이유
  - **`코드는 선형적이지 않다`**
    - 같은 로직을 통과하면서도 여러 경로가 만들어짐 
    <img width="464" alt="CleanShot 2024-05-14 at 16 35 47@2x" src="https://github.com/Deep-Dive-Study/troubleshooting-java/assets/99165624/16e80176-628e-47f5-ad04-8de3039c901e">

  - 코드는 항상 모든 사람에게 동일한 의미를 지녀야 한다
    - 일반 글과는 다르게 사람마다 해석이 다르면 안됨 

## 2.2 디버거를 이용한 코드 조사
- 디버거(Debugger)는 **`원하는 코드 라인에서 실행을 잠깐 멈추고 각 커맨드를 수동 실행하며 데이터가 어떻게 바뀌는지 확인할 수 있는 도구`**
  - 복잡한 코드 속에서 길을 찾기 위한 나침반 역할
- 디버거를 사용하게 되면 **`조사 프로세스가 간소화`** 됨
  - 특정 스텝에서 잠깐 실행을 멈추고 각 커맨드를 본인 페이스에 맞게 수동 실행할 수 있다
  - 코드를 읽는 과정에서 현재 위치와 변수, 등의 세부 정보를 보여주기 때문에 일일이 기억할 필요가 없다.
  - 와처를 통해 변수의 변화를 감지하기 편리하고, 표현식을 통해 실시간으로 코드를 실행해보면서 테스트해볼 수 있다

- 즉, 디버거는 로직의 흐름을 더욱 잘 관찰할 수 있고, 실행을 조정하여 테스트 해볼 수 있도록 다양한 기능을 제공하여 사용자가 코드를 빠르게 이해하기 편하도록 도움을 줌 

- **`디버거를 언제 사용해야 할까?`**
  - **`지금 내가 조사하려는 로직이 무엇인지 알고 있을때`**
   - 디버거를 사용하기 위한 첫 단계는 확인하고자 하는 로직의 브레이크 포인트(실행 중단 지점)을 선택하는 것
 
 - 따라서, 내가 어디를 확인해야 하는지 모른다면, 먼저 어디를 조사해야할지 범위를 좁히는 작업 부터 이뤄져야 함
   - 해당 내용은 로깅, 프로파일링, 등의 기법을 활용하면 되기 때문에 뒷장에서 다룸     

- 먼저, 디버거 없이 코드를 눈으로 읽고, 이해하기 위한 시도롤 하는 것이 좋음
- 그래야 내가 확인하고자 하는 부분(문제 지점)만 빠르게 찾아 확인할 수 있음(시간 절약)
- 또한, 마우스보다 단축키를 활용하는 것이 빠르기 때문에 좋음

### 2.2.1 실행 스택 트레이스란 무엇이고 어떻게 사용해야 할까?
- 실행 스택 트레이스란?
  - 디버거가 중단시킨 코드 라인의 실행 경로

    <img width="452" alt="CleanShot 2024-05-14 at 17 03 02@2x" src="https://github.com/Deep-Dive-Study/troubleshooting-java/assets/99165624/708b7f9b-acf8-4e3f-b334-880426691d08">

- 스프링과 같은 프레임워크를 사용하는 경우에는 Aspect/Intercepter 와 같은 디커플링을 돕는 코드를 사용하는 특성 탓에 원하는 기능을 조사하는 것이 쉽지는 않음
  <img width="450" alt="CleanShot 2024-05-14 at 17 04 56@2x" src="https://github.com/Deep-Dive-Study/troubleshooting-java/assets/99165624/5477f22a-01b3-4fcd-bf5b-2ad9a62b9660">

  - 이런 경우에 대한 팁을 따로 안주는 것은 책의 아쉬운 점..
  - 디버깅할때 이러한 점 때문에 어려움을 많이 겪었음 → 스텝 인투 했는데 프록시 객체..

### 2.2.2 디버거로 코드 탐색하기
- 책의 내용만으로는 어려울 수 있기 때문에, 실습 혹은 영상을 통해 직접 보면서 해보는 것을 권장함

- 디버거로 코드를 탐색하는 기본 동작
  - `스텝 오버(step over)` : 동일한 메서드에서 다음 코드 라인으로 계속 실행(**다음 코드 실행 라인**)
  - `스텝 인투(step into)` : 현재 라인에서 호출된 메서드 중 하나의 내부에서 실행 계속
  - `스텝 아웃(step out)` : 조사하던 메서드를 호출한 메서드로 실행을 되돌림(실행 후 되돌아감)

    <img width="424" alt="CleanShot 2024-05-14 at 18 23 29@2x" src="https://github.com/Deep-Dive-Study/troubleshooting-java/assets/99165624/097644b9-ea5d-491f-b92f-76fabe582a6c">
    <img width="424" alt="CleanShot 2024-05-14 at 18 19 19@2x" src="https://github.com/Deep-Dive-Study/troubleshooting-java/assets/99165624/d84e0bec-9419-4c6d-998f-0f290a4fd1bb">

- 먼저, 디버거로 실행을 중단 시킬 첫 번째 코드 라인을 정하고(로직을 확인해 보고 싶은 지점 파악)
- 다음, 코드 라인을 하나씩 실행하면서 데이터가 어떻게 변화하고 로직이 어떻게 진행되는지 따라가면서 확인
  - 스텝 인투를 할 때 마다 새로운 조사 플랜이 열리게 되며, 숨겨진 로직을 파악할 수 있고 깊이 들어가서 작동 원리를 명확하게 이해할 수 있는 장점이 있으나, 파악해야하는 프로세스가 점점 복잡해져(인지 복잡도 증가) 길을 잃을 수 있음

    <img width="447" alt="CleanShot 2024-05-14 at 18 28 12@2x" src="https://github.com/Deep-Dive-Study/troubleshooting-java/assets/99165624/7ca4630e-5721-4040-85c7-713f76d82d23">
    
  <img width="444" alt="CleanShot 2024-05-14 at 18 27 38@2x" src="https://github.com/Deep-Dive-Study/troubleshooting-java/assets/99165624/610ef3cc-b4fa-4e8e-90fc-9c9843ad5ae1">


## 2.3 디버거로도 충분하지 않다면
- 디버거로 모든 코드를 디버깅할 수 있는 것은 아님
  - `코드의 어느 부분이 아웃풋을 내는지 모르는 채 아웃풋 문제를 조사하는 경우`
  - `성능 문제를 조사하는 경우`
  - `앱 전체가 중단된 문제를 조사하는 경우`
  - `멀티 스레드 구현체를 조사하는 경우`
 
- 즉, 어느 지점에서 중단을 시켜야 하는지 모른다면 소용 없음
  - 다양한 방법을 통해 먼저 로직을 살펴봐야하는 범위를 좁히는 작업을 진행해야함 

## 요약
- 디버깅 툴의 기본적인 사용법
- 어떤 상황에 어떻게 디버깅을 사용하면 좋을지에 대한 예시
  
  <img width="435" alt="CleanShot 2024-05-14 at 16 59 26@2x" src="https://github.com/Deep-Dive-Study/troubleshooting-java/assets/99165624/48ab6f90-eeea-4912-825f-7fced2940d89">
